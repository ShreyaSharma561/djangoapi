{% extends 'base.html' %}

{% block title %}Blog Details - BlogApp{% endblock %}

{% block style %}
#detail-container{
    max-width:900px;
    margin:40px auto;
    padding:20px;
}

.blog-detail{
    background:#fff;
    padding:25px;
    border-radius:12px;
    box-shadow:0 5px 15px rgba(0,0,0,0.08);
}

.blog-detail img{
    width:100%;
    max-height:400px;
    object-fit:cover;
    border-radius:10px;
    margin-bottom:20px;
}

.blog-detail h1{
    margin-bottom:10px;
}

.meta{
    font-size:14px;
    color:gray;
    margin-bottom:20px;
}

.blog-content{
    font-size:16px;
    line-height:1.7;
    color:#333;
}

.back-btn{
    display:inline-block;
    margin-bottom:20px;
    text-decoration:none;
    color:#0d6efd;
    font-weight:500;
}
.back-btn:hover{
    text-decoration:underline;
}
{% endblock %}

{% block content %}
<div id="detail-container">
    <a href="/" class="back-btn">‚Üê Back to Blogs</a>

    <div id="blogDetail">Loading...</div>
</div>
{% endblock %}

{% block extra_js %}
<script>
const postId = "{{ post_id }}";

fetch(`/api/posts/${postId}/`)
.then(res => {
    if(!res.ok){
        throw new Error("Post not found");
    }
    return res.json();
})
.then(post => {
    document.getElementById("blogDetail").innerHTML = `
        <div class="blog-detail">
            ${post.featured_image ? `<img src="${post.featured_image}" alt="${post.title}">` : ''}
            
            <h1>${post.title}</h1>

            <div class="meta">
                By ${post.author || 'Anonymous'} |
                Category: ${post.category || 'Uncategorized'} |
                Status: ${post.status} |
                ${new Date(post.created_at).toLocaleDateString()}
            </div>

            <div class="blog-content">
                ${post.content}
            </div>
        </div>
    `;
})
.catch(err => {
    console.error(err);
    document.getElementById("blogDetail").innerHTML =
        "<p>Blog not found or error loading post.</p>";
});
</script>
{% endblock %}
